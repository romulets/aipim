(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{8586:(e,t,s)=>{Promise.resolve().then(s.bind(s,6716))},6716:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var l=s(5155),a=s(2115),n=s(5565),c=s(6531);class i{constructor(){this.defaultRelatedEntities=[],this.defaultActor="",this.sources=[]}}class r{constructor(e){this.sourceName="",this.events=[],this.relatedEntityFields=[],e&&(this.sourceName=e)}}class d{constructor(e){this.eventName="",this.targetFields=[],this.actorField="",e&&(this.eventName=e)}}class o{constructor(){this.default=!1,this.sources=-1}}class m{constructor(){this.sources=0,this.events=0,this.targets=0,this.relatedEntities=0}}function u(){let[e,t]=(0,a.useState)(new i),[s,u]=(0,a.useState)(new m),[h,x]=(0,a.useState)(new o),[p,f]=(0,a.useState)(""),v=(0,a.useCallback)(()=>{x(()=>({default:!h.default,sources:-1}))},[h]),N=async e=>{let t=new m;t.relatedEntities+=e.defaultRelatedEntities.length,t.sources=e.sources.length,e.sources.forEach(e=>{t.events+=e.events.length,t.relatedEntities+=e.relatedEntityFields.length,e.events.forEach(e=>{t.targets+=e.targetFields.length})}),u(t)},j=e=>()=>{if(h.sources==e){x(()=>new o);return}x(()=>({default:!1,sources:e}))},b=e=>e?"collapse-arrow-open":"collapse-arrow-closed",g=e=>e?"collapse-body-open":"collapse-body-closed",E=null,y=s=>{null!=E&&E.abort(),E=new AbortController;let l={...e,...s};t(l),N(l),(async()=>{let e=await fetch("".concat("","/api/mapping/to-painless"),{method:"POST",mode:"cors",body:JSON.stringify(l),headers:{"Content-Type":"application/json"},signal:E.signal});f(await e.text()),E=null})()},F=null,w=e=>{null!=F&&F.abort(),F=new AbortController,f(e),(async()=>{let s=await fetch("".concat("","/api/mapping/from-painless"),{method:"POST",mode:"cors",body:e,signal:F.signal});if(200!=s.status){alert(await s.text());return}let l=await s.json();t(l),N(l),F=null})()};return(0,l.jsxs)("div",{className:"h-screen",children:[(0,l.jsxs)("div",{className:"header flex h-[7dvh] p-2",children:[(0,l.jsxs)("div",{className:"flex flex-1",children:[(0,l.jsx)(n.default,{className:"w-8 flex-none",src:"/aipim-background.svg",alt:"Aipim Logo",width:30,height:30,priority:!0}),(0,l.jsx)("h1",{className:"flex-none p-2 mt-1",children:(0,l.jsx)("b",{children:"Aipim"})})]}),(0,l.jsxs)("div",{className:"flex flex-2 mt-1",children:[(0,l.jsx)("b",{className:"p-1 pt-2",children:" Sources:"}),(0,l.jsx)("span",{className:"p-1 pt-2",children:s.sources}),(0,l.jsx)("b",{className:"p-1 pt-2",children:" Events:"}),(0,l.jsx)("span",{className:"p-1 pt-2",children:s.events}),(0,l.jsx)("b",{className:"p-1 pt-2",children:" Related Entities:"}),(0,l.jsx)("span",{className:"p-1 pt-2",children:s.relatedEntities}),(0,l.jsx)("b",{className:"p-1 pt-2",children:" Targets:"}),(0,l.jsx)("span",{className:"p-1 pt-2",children:s.targets})]})]}),(0,l.jsxs)("main",{className:"flex h-[89dvh]",children:[(0,l.jsxs)("section",{className:"flex-1 p-5 overflow-y-auto",children:[(0,l.jsxs)("div",{className:"form-section mb-2 flex flex-col",children:[(0,l.jsxs)("button",{onClick:v,className:"p-2 flex-1 text-left",children:[(0,l.jsx)(n.default,{className:"inline mr-3 collapse-arrow ".concat(b(h.default)),src:"arrow.svg",alt:"icon collapse",width:5,height:5,priority:!0}),(0,l.jsx)("b",{children:"Default Values"})]}),(0,l.jsxs)("div",{className:"collapse-body ".concat(g(h.default)),children:[(0,l.jsxs)("div",{className:"flex p-2",children:[(0,l.jsx)("label",{className:"mr-2 p-1 form-label",htmlFor:"default-actor",children:"Default actor"}),(0,l.jsx)("input",{className:"text-input p-1  w-4/5",type:"text",id:"default-actor",name:"default-actor",onChange:e=>y({defaultActor:e.target.value}),value:e.defaultActor})]}),(0,l.jsxs)("div",{className:"inc-list-header flex",children:[(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)("label",{className:"title",children:"Default Related Entities"})}),(0,l.jsx)("button",{className:"flex-2 main-btn add-btn",onClick:()=>y({defaultRelatedEntities:[...e.defaultRelatedEntities,""]}),children:"+ Add Related Entity"})]}),(0,l.jsx)("div",{className:"inc-list p-4 pr-2 m-2 mt-5 mr-0",children:0==e.defaultRelatedEntities.length?(0,l.jsx)("p",{children:"No default related entities"}):e.defaultRelatedEntities.map((t,s)=>(0,l.jsxs)("div",{className:"",children:[(0,l.jsx)("input",{className:"text-input p-1",type:"text",onChange:t=>{let l=[...e.defaultRelatedEntities];l[s]=t.target.value,y({defaultRelatedEntities:l})},value:e.defaultRelatedEntities[s]}),(0,l.jsx)("button",{className:"col-span-1 main-btn remove-btn",onClick:()=>{let t=[...e.defaultRelatedEntities];t.splice(s,1),y({defaultRelatedEntities:t})},children:"-"})]},"default-related-".concat(s)))})]})]}),(0,l.jsxs)("div",{className:"form-section mb-2 p-2 flex contrast",children:[(0,l.jsx)("h2",{className:"font-bold flex-1",children:"Event Sources"}),(0,l.jsx)("button",{onClick:()=>{let t=e.sources.length;y({sources:[...e.sources,new r("aws_source")]}),j(t)()},className:"main-btn flex-3 sm",children:"+ Add Event Source"})]}),e.sources.map((t,s)=>{let a=h.sources==s,c=t=>{e.sources[s]={...e.sources[s],...t},y({...e})};return(0,l.jsxs)("div",{className:"form-section mb-2",children:[(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsxs)("button",{onClick:j(s),className:"p-2 flex-1 text-left",children:[(0,l.jsx)(n.default,{className:"inline mr-3 collapse-arrow ".concat(b(h.sources==s)),src:"arrow.svg",alt:"icon collapse",width:5,height:5,priority:!0}),(0,l.jsx)("b",{children:t.sourceName})," ",(0,l.jsx)("small",{children:"event source"})]}),(0,l.jsx)("div",{className:"flex-3 content-center mr-1",children:(0,l.jsx)("button",{className:"main-btn sm",onClick:()=>{let t=[...e.sources];t.splice(s,1),y({sources:t}),a&&x(new o)},children:"- Remove Source"})})]}),(0,l.jsxs)("div",{className:"collapse-body ".concat(g(h.sources==s)),children:[(0,l.jsxs)("div",{className:"flex p-2",children:[(0,l.jsx)("label",{className:"mr-2 p-1 form-label",htmlFor:"source-name-".concat(s),children:"Source name"}),(0,l.jsx)("input",{className:"text-input p-1",type:"text",id:"source-name-".concat(s),name:"source-name-".concat(s),onChange:e=>c({sourceName:e.target.value}),value:e.sources[s].sourceName})]}),(0,l.jsxs)("div",{className:"inc-list-header flex",children:[(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)("label",{className:"title",children:"Related Entities"})}),(0,l.jsx)("button",{className:"flex-2 main-btn add-btn",onClick:()=>c({relatedEntityFields:[...t.relatedEntityFields,""]}),children:"+ Add Related Entity"})]}),(0,l.jsx)("div",{className:"inc-list p-4 pr-2 m-2 mt-5 mr-0",children:0==t.relatedEntityFields.length?(0,l.jsx)("p",{children:"No specific related entities"}):t.relatedEntityFields.map((e,s)=>(0,l.jsxs)("div",{className:"",children:[(0,l.jsx)("input",{className:"text-input p-1",type:"text",onChange:e=>{let l=[...t.relatedEntityFields];l[s]=e.target.value,c({relatedEntityFields:l})},value:t.relatedEntityFields[s]}),(0,l.jsx)("button",{className:"col-span-1 main-btn remove-btn",onClick:()=>{let e=[...t.relatedEntityFields];e.splice(s,1),c({relatedEntityFields:e})},children:"-"})]},"default-related-".concat(s)))}),(0,l.jsxs)("div",{className:"ml-3 pl-1 pb-1 mt-4 flex title-divider",children:[(0,l.jsx)("h2",{className:"flex-1",children:"Events"}),(0,l.jsx)("button",{className:"main-btn sm flex-2",onClick:()=>{t.events=[...e.sources[s].events,new d("".concat(t.sourceName,"Event"))],c(t)},children:"+ Add Event"})]}),(0,l.jsx)("div",{className:"ml-3 events-holder",children:t.events.map((e,a)=>{let n=e=>{t.events[a]={...t.events[a],...e},c({...t})};return(0,l.jsxs)("div",{className:"pl-5 pb-1 pt-4",children:[(0,l.jsxs)("div",{className:"pb-1 flex title-sub-divider",children:[(0,l.jsx)("h2",{className:"flex-1 font-bold",children:e.eventName}),(0,l.jsx)("button",{className:"main-btn sm flex-2",onClick:()=>{let e=[...t.events];e.splice(s,1),c({events:e})},children:"- Remove Event"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-6 pl-2 pt-2",children:[(0,l.jsx)("label",{className:"mr-2 p-1 form-label",htmlFor:"event-name-".concat(s,"-").concat(a),children:"Event Name"}),(0,l.jsx)("input",{className:"col-span-5 text-input p-1",type:"text",id:"event-name-".concat(s,"-").concat(a),name:"event-name-".concat(s,"-").concat(a),onChange:e=>n({eventName:e.target.value}),value:e.eventName})]}),(0,l.jsxs)("div",{className:"grid grid-cols-6 pl-2 pt-2 pb-2",children:[(0,l.jsx)("label",{className:"mr-2 p-1 form-label",htmlFor:"actor".concat(s,"-").concat(a),children:"Specific Actor"}),(0,l.jsx)("input",{className:"col-span-5 text-input p-1",type:"text",id:"actor".concat(s,"-").concat(a),name:"actor".concat(s,"-").concat(a),onChange:e=>n({actorField:e.target.value}),value:e.actorField})]}),(0,l.jsxs)("div",{className:"inc-list-header flex",children:[(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)("label",{className:"title",children:"Targets"})}),(0,l.jsx)("button",{className:"flex-2 main-btn add-btn",onClick:()=>n({targetFields:[...e.targetFields,""]}),children:"+ Add Target"})]}),(0,l.jsx)("div",{className:"inc-list p-4 pr-2 m-2 mt-5 mr-0",children:0==e.targetFields.length?(0,l.jsx)("p",{children:"No targets"}):e.targetFields.map((t,s)=>(0,l.jsxs)("div",{className:"",children:[(0,l.jsx)("input",{className:"text-input p-1",type:"text",onChange:t=>{let l=[...e.targetFields];l[s]=t.target.value,n({targetFields:l})},value:e.targetFields[s]}),(0,l.jsx)("button",{className:"col-span-1 main-btn remove-btn",onClick:()=>{let t=[...e.targetFields];t.splice(s,1),n({targetFields:t})},children:"-"})]},"".concat(s)))})]},"".concat(s,"-").concat(a))})})]})]},s)})]}),(0,l.jsx)(c.A,{className:"flex-1",value:p,language:"dart",placeholder:"// code here",onChange:e=>w(e.target.value),padding:15,"data-color-mode":"dark",style:{fontFamily:"ui-monospace,SFMono-Regular,SF Mono,Consolas,Liberation Mono,Menlo,monospace",overflowY:"scroll"}})]}),(0,l.jsxs)("footer",{className:"footer h-[4dvh] text-xs  p-2 text-center",children:["Aipim - ",(0,l.jsx)("b",{children:"AWS Interfaced Painless Identifier Mapping"})," - Made by @romulets and @kubasobon (Elastic 2025)"]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[393,643,441,517,358],()=>t(8586)),_N_E=e.O()}]);